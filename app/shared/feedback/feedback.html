<section class="tables-data feedback">

  <!-- for ng-table checkboxes -->
  <!-- TODO:  Weird styling issues where nav navbar nav-header classes are getting drawn in
  resulting in elements being placed outside of the table (i.e. position: fixed)
  -->
  <script type="text/ng-template" id="checkboxheader.html">
    <input type="checkbox" ng-model="selectAllActive" ng-click="selectAll(selectAllActive)">
  </script>

  <script type="text/ng-template" id="filterHeader.html">
    <input type="text" ng-model="filter">

  </script>

  <script type="text/ng-template" id="ng-table/filters/hasFeedback.html">
    <input type="checkbox" ng-model="params.filter()[messages]" name="filter-age" value=""/> None
    <br/>
    <input type="radio" ng-model="params.filter()[name]" name="filter-age" value="50"/> 50 years
  </script>
  <style>
.col-md-12.feedback-area{padding-left:10px;padding-right:10px}
.angular-ui-tree-nodes .angular-ui-tree-nodes {
    padding-left: 0px;
}
.feedback ol {
    margin-top: 0;
    margin-bottom: 1px;
    -webkit-padding-start: 0px;
    margin-left: 11px;
}
  </style>

    <!-- sidebar -->
      <div class="editpanel sca-column col-lg-3 col-md-3 col-sm-3 no-padding"
           ng-include src="'shared/sidebar-edit/sidebarEdit.html'"></div>
 


  <!-- Report, feedback editor, and concept feedback -->

  <!-- Taxonomy, models, and concepts -->
  <div class="col-md-9 no-padding" ng-if="viewedConcepts.length > 0">
  <div class="row m-l-10 no-gutter" ng-if="!feedbackContainer.review">
              <div class="m-10">Loading review...</div>
            </div>

    <div class="">

      <div class="row no-padding no-gutter white" ng-repeat="concept in viewedConcepts">
        <div class="col-md-6">

          <div draw-model-sca concept="concept" snf-function="getSNF(concept.conceptId)" display-snf="true"></div>
          
       
        </div>
        <div class="col-md-6">
          <div concept-edit concept="concept" branch="branch" static="true" component-styles="styles[concept.conceptId]"
               autosave="false"></div>
        </div>
        <div class="col-md-12 row-fluid no-padding no-gutter" style="display: flex;"  ng-show="!isCollapsed">
            <div class="col-md-6 no-padding no-gutter">
            <!-- Loading placeholder -->
          

            <!-- Main report and feedback content (once loaded) -->
            <div class="row m-l-10 no-gutter" ng-if="feedbackContainer.review">

              <!-- Review report (concept list) -->


       
              <!-- Feedback messages -->
            </div>
          </div>
            <div class="col-md-6 no-gutter no-padding darken-3 grey" ></div> 
          </div>

      </div>
             
              <div class="col-md-12 light_greys no-padding"  ng-show="subjectConcepts.length > 0">

    <div class=" pull-left clear-button tooltips-left tooltips-light normal-case p-l-10 " 
                    ng-click="selectConceptForFeedback(concept)">
          <strong> {{viewedFeedback.length}} </strong>Total Comments for  <span ng-repeat="subjectConcept in subjectConcepts">{{subjectConcept.term}}</span></div>
        
</div>
   <div class="col-md-12 feedback-area">
                            <div class="col-md-6 no-padding feedback-chat " ng-show="subjectConcepts.length > 0">

                <div class="no-feedback-yet" ng-show="viewedFeedback.length === 0">
                  No Feedback added yet...
                </div>

                <div ng-repeat="feedback in viewedFeedback | orderBy: getDateFromFeedback : true">


                 <p compile-html="feedback.messageHtml" class="reviewer-feedback-chat col-md-12 " style="word-break: break-all; margin: 0px" 
                 ng-class="[{
                          author_feedback_chat : task.assignee.username  === feedback.fromUsername
                          }]"
                          
                          ></p>
                    <button class="btn btn-round btn-default purple lighten-2 tooltips-left tooltips-light normal-case"
                            ng-show="feedback.feedbackRequested" >
                      <div
                        class="md md-flag"></div>
                      <span>Reviewer requested follow-up</span></button>
                         <div class="feedback-header" ng-class="[{
                          pull_right : task.assignee.username  === feedback.fromUsername
                          }]">
                    <span class="username">{{feedback.fromUsername}} </span>
                    <span class="date">{{feedback.creationDate | date:"MM/dd 'at' h:mma"}}</span>
                    <span class="username" ng-show="subjectConcepts.length > 1">On concept {{feedback.conceptName}}</span>
                  </div>



                </div>

              </div>

<div class="feedback-window col-md-6 no-padding m-t-10">

                <text-angular ui-on-drop="dropConceptIntoEditor($data)" drop-channel="feedbackConcept"
                              ng-model="$parent.htmlVariable"
                                ta-text-editor-class="form-control myform2-height" ta-html-editor-class="form-control myform2-height"
                              ta-toolbar="[['bold','italics', 'ul', 'ol', 'createLink']]"></text-angular>
                                <div class="col-md-12 no-padding">
                 
                     <div class="col-md-6 no-padding concept-filter ">
                  <input type="text" class="feedback-search " placeholder="Search concepts..."
                         ui-on-drop=""
                         ng-model="conceptFilter"
                         typeahead="suggestion as suggestion.concept.fsn for suggestion in getConceptsForTypeahead($viewValue)"
                         typeahead-focus-first="false"
                         typeahead-wait-ms="500"
                         typeahead-on-select="addConceptToFeedback($item)"
                         typeahead-editable="false" typeahead-min-length="3">
                </div>
 <div class="col-md-6 no-padding">
                  <div class="pull-left follow-up" ng-show="role === 'REVIEWER'"><span
                    class="pull-left p-t-10"> Request follow-up </span><span
                    class="pull-left p-5"><input type="checkbox" ng-model="requestFollowup"></span>
                  </div>

                  <div class="pull-right follow-up-right ">
                    <a class="pull-right clear-button tooltips-left tooltips-light normal-case m-r-5"
                            ng-click="submitFeedback(requestFollowup)"
                            style="text-transform: none"> <div class="md md-forum ">Send</div>
                    </a>
                     <a ng-if="role === 'REVIEWER'" class="pull-right clear-button tooltips-left tooltips-light normal-case m-r-5" ng-click="addToReviewed(concept)" style="text-transform: none"><div class="md md-thumb-up ">Approve</div>
                    </a>
                      <a class="pull-right clear-button tooltips-left tooltips-light normal-case m-r-5" ng-click="htmlVariable = ''"
                            style="text-transform: none"><div class="md md-send ">Clear</div>
                    </a>

                  </div>
                  </div>
                </div>
</div>
</div>

              


              </div>


  </div>

  <!-- Extra padding just in case -->
  <div class="m-b-50">&nbsp;</div>

</section>