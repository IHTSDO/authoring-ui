<section class="tables-data feedback">

  <!-- for ng-table checkboxes -->
  <!-- TODO:  Weird styling issues where nav navbar nav-header classes are getting drawn in
  resulting in elements being placed outside of the table (i.e. position: fixed)
  -->
  <script type="text/ng-template" id="checkboxheader.html">
    <input type="checkbox" ng-model="selectAllActive" ng-click="selectAll(selectAllActive)">
  </script>

  <script type="text/ng-template" id="filterHeader.html">
    <input type="text" ng-model="filter">

  </script>

  <script type="text/ng-template" id="ng-table/filters/hasFeedback.html">
    <input type="checkbox" ng-model="params.filter()[messages]" name="filter-age" value=""/> None
    <br/>
    <input type="radio" ng-model="params.filter()[name]" name="filter-age" value="50"/> 50 years
  </script>
  <style>
  .ta-editor.form-control.myform2-height, .ta-scroll-window.form-control.myform2-height  {
    height: 100px;
    min-height: 100px;
    overflow: auto;
    font-family: inherit;
    font-size: 100%;
	display:block;
}
.form-control.myform2-height > .ta-bind {
    min-height: 95px;
    padding: 6px 12px;
}
.clear-button{background-color:transparent}
.clear-button:hover{background-color:transparent}
  </style>

    <!-- sidebar -->
      <div class="editpanel sca-column col-lg-3 col-md-3 col-sm-3 no-padding"
           ng-include src="'shared/sidebar-edit/sidebarEdit.html'"></div>
 


  <!-- Report, feedback editor, and concept feedback -->

  <!-- Taxonomy, models, and concepts -->
  <div class="col-md-9 no-padding" ng-if="viewedConcepts.length > 0">


    <div class="">

      <div class="row no-padding no-gutter" ng-repeat="concept in viewedConcepts">
        <div class="col-md-6">

          <div draw-model-sca concept="concept" snf-function="getSNF(concept.conceptId)" display-snf="true"></div>
          <a
                    class=" pull-right clear-button tooltips-left tooltips-light normal-case m-r-5 "
                    ng-click="selectConceptForFeedback(concept)">
              <div class="md md-forum "> Leave Feedback</div>
              <span>View/submit feedback for concept</span> </a>
        </div>
        <div class="col-md-6">
          <div concept-edit concept="concept" branch="branch" static="true" component-styles="styles[concept.conceptId]"
               autosave="false"></div>
        </div>
        <div class="col-md-12 row-fluid no-padding no-gutter" style="display: flex;"  ng-show="!isCollapsed">
            <div class="col-md-6 no-padding no-gutter">
            <!-- Loading placeholder -->
            <div class="row m-l-10 no-gutter" ng-if="!feedbackContainer.review">
              <div class="m-10">Loading review...</div>
            </div>

            <!-- Main report and feedback content (once loaded) -->
            <div class="row m-l-10 no-gutter" ng-if="feedbackContainer.review">

              <!-- Review report (concept list) -->


              <div class="col-md-12 feedback-window" ng-show="subjectConcepts.length > 0">



                <text-angular ui-on-drop="dropConceptIntoEditor($data)" drop-channel="feedbackConcept"
                              ng-model="$parent.htmlVariable"
                                ta-text-editor-class="form-control myform2-height" ta-html-editor-class="form-control myform2-height"
                              ta-toolbar="[['bold','italics', 'ul', 'ol', 'createLink']]"></text-angular>


                <div class="col-md-12 no-padding m-t-10">
                  <div class="col-md-6 no-padding">
                  <div class="pull-left follow-up" ng-show="role === 'REVIEWER'"><span
                    class="pull-left p-t-10"> Request follow-up </span><span
                    class="pull-left p-5"><input type="checkbox" ng-model="requestFollowup"></span>
                  </div>

                  <div class="pull-right follow-up-right ">
                    <button class="btn btn-default grey classify-buttons submit-review"
                            ng-click="submitFeedback(requestFollowup)"
                            style="text-transform: none">Submit Feedback
                    </button>
                    <button class="btn btn-default amber classify-buttons submit-validation" ng-click="htmlVariable = ''"
                            style="text-transform: none">Clear
                    </button>

                  </div>
                  </div>
                     <div class="col-md-6 no-padding concept-filter ">
                  <input type="text" class="feedback-search " placeholder="Search concepts..."
                         ui-on-drop=""
                         ng-model="conceptFilter"
                         typeahead="suggestion as suggestion.concept.fsn for suggestion in getConceptsForTypeahead($viewValue)"
                         typeahead-focus-first="false"
                         typeahead-wait-ms="500"
                         typeahead-on-select="addConceptToFeedback($item)"
                         typeahead-editable="false" typeahead-min-length="3">
                </div>

                </div>



              </div>
        <style>
        .triangle-isosceles {
            position: relative;
            padding: 7px;
            margin: 1em 0 3em;
            color: #000;
            background: #f3961c;
            background: -webkit-gradient(linear, 0 0, 0 100%, from(#ececec), to(#ececec));
            background: -moz-linear-gradient(#ececec, #ececec);
            background: -o-linear-gradient(#ececec, #ececec);
            background: linear-gradient(#ececec, #ececec);
            -webkit-border-radius: 2px;
            -moz-border-radius: 2px;
            border-radius: 2px;
        }
        /* THE TRIANGLE
        ------------------------------------------------------------------------------------------------------------------------------- */

        /* creates triangle */
        .triangle-isosceles:after {
          content:"";
          position:absolute;
          bottom:-7px; /* value = - border-top-width - border-bottom-width */
          left:20px; /* controls horizontal position */
          border-width:7px 7px 0; /* vary these values to change the angle of the vertex */
          border-style:solid;
          border-color:#ececec transparent;
          /* reduce the damage in FF3.0 */
          display:block;
          width:0;
        }
        </style>
              <!-- Feedback messages -->
              <div class="col-md-12 feedback-chat p-10" ng-show="subjectConcepts.length > 0">

                <div class="no-feedback-yet" ng-show="viewedFeedback.length === 0">
                  No Feedback added yet...
                </div>

                <div ng-repeat="feedback in viewedFeedback | orderBy: getDateFromFeedback : true">


                 <p compile-html="feedback.messageHtml" class="triangle-isosceles col-md-12 " style="word-break: break-all; margin: 0px"></p>
                    <button class="btn btn-round btn-default purple lighten-2 tooltips-left tooltips-light normal-case"
                            ng-show="feedback.feedbackRequested">
                      <div
                        class="md md-flag"></div>
                      <span>Reviewer requested follow-up</span></button>
                         <div class="feedback-header">
                    <span class="username">{{feedback.fromUsername}} </span>
                    <span class="date">{{feedback.creationDate | date:"MM/dd/yyyy 'at' h:mma"}}</span>
                    <span class="username" ng-show="subjectConcepts.length > 1">On concept {{feedback.conceptName}}</span>
                  </div>



                </div>

              </div>
            </div>
          </div>
            <div class="col-md-6 no-gutter no-padding" style="background-color:#2d2d2d;"></div> 
          </div>

      </div>

    </div>

  </div>

  <!-- Extra padding just in case -->
  <div class="m-b-50">&nbsp;</div>

</section>