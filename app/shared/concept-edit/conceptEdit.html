<div class="edits editing-form ">
<style>
</style>

  <!-- begin validation error -->
  <div class="alert alert-dismissible alert-danger validation" ng-show="error">
    <button type="button" class="close" data-dismiss="alert">×</button>
    <h4>Validation Error!</h4>
    {{error}}
  </div>
  <div class="alert alert-dismissible alert-warning validation" ng-show="warning">
    <button type="button" class="close" data-dismiss="alert">×</button>
    <h4>Warning</h4>
    {{warning}}
  </div>
  <!-- end validation error -->
  <div class="row p-t-5 grey darken-4 concept-headers " style=" margin-right:0px;">
    <div class="pull-left col-md-1 no-padding">

      <button ng-click="setConceptProperties(concept)" type="button"
              class="btn btn-default morebuttons grey darken-4 md fa fa-ellipsis-v more-button-width tooltips-left tooltips-light normal-case"
              popover-template="'shared/component-more/conceptMore.html'" popover-placement="left"
              popover-trigger="click: click"><span>More details</span></button>

      <button
        class="btn btn-default morebuttons grey darken-4 md md-open-with normal-case drag-button-width "
        ui-draggable="true" drag="getConceptIdNamePair(concept)" drag-channel="conceptPropertiesObj"
        drop-channel="NA" drag-image="getDragImageForConcept(concept.fsn)"></button>


     

    </div>


    <!-- concept name -->
    <div class="pull-left col-md-6 no-padding title-text"
      >
      <button type="button" class="btn-default grey darken-4 title-text fsn-title-button">
        <span class="fsn p-t-5">{{concept.fsn}}</span>

          <span
            ng-show="!concept.fsn && !concept.effectiveTime" style="color:grey">Unsaved Concept</span></button>
    </div>

    <div class="pull-right m-l-4 m-r-5 col-md-1 no-padding ">
      <select name="select-primitive-choice" id="select-primitive-choice"
              ng-disabled="isStatic"
              ng-model="concept.definitionStatus"
              ng-change="toggleConceptDefinitionStatus()"
              class="form-control grey darken-4 primitive pull-left"
              style="width:30px;"
              ng-options="definitionStatus.id as definitionStatus.name for definitionStatus in definitionStatuses">
      </select>

      <div class="pull-right">
        <button ng-init="isCollapsed = false" ng-click="collapse(concept)" type="button"
                ng-class="[btn, btn-default, darkbuttons, grey, 'darken-4', 'toggle-buttons', md, {'fa fa-caret-down' : isCollapsed, ' fa fa-caret-up' : !isCollapsed}]"></button>
      </div>
    </div>
    <div class="pull-right no-margin edits concept-title col-md-4 no-padding">
 <button ng-click="saveConcept()" type="button"
              class="btn-default save-button small-buttons deep-purple lighten-2 md md-save tooltips-left tooltips-light normal-case "
              ng-click="saveConcept()"
              ng-if="isModified"><span> Save Concept </span></button>
      <!-- Revert button only appears if parent is specified -->
      <button ng-if="parentBranch" type="button" class="btn btn-default revert-button" ng-click="revertConcept()">
        Revert
      </button>

      <!-- control buttons -->
      <button ng-if="!isStatic"
              type="button"
              style="vertical-align: bottom"
              ng-class="[btn-default, editbuttons, ' fa fa-power-off', {green : concept.active}, {red: !concept.active}]"
              ng-click="toggleConceptActive(concept)" class="small-buttons tooltips-left tooltips-light normal-case">
        <span> Activate/ inactivate concept </span></button>
      <button type="button"
              style="vertical-align: bottom"
              class="btn-default editbuttons small-buttons color_{{relationship.groupId}} tooltips-left tooltips-light normal-case"
              ng-class="[{'red fa fa-level-down' : !hideInactive}, {'fa fa-level-up green' : hideInactive}]"
              ng-click="toggleHideInactive()"><span> Show/hide inactive components </span></button>


      <button type="button" class="btn-default editbuttons small-buttons amber md md-undo "
              title="Undo Changes"
              ng-click="undo()"
              ng-disabled="conceptHistoryPtr < 1"
              ng-if="!isStatic"></button>
      <button type="button" class="btn-default editbuttons small-buttons amber md md-redo "
              title="Redo Changes"
              ng-click="redo()"
              ng-if="!isStatic"
              ng-disabled="conceptHistoryPtr === conceptHistory.length - 1"></button>
      <button type="button" class="btn-default editbuttons small-buttons deep-purple lighten-2 md md-history"
              title="Revert to Saved"
              ng-click="undoAll()"
              ng-if="!isStatic"
              ng-disabled="!isModified"></button>
      <button type="button"
              class="btn-default editbuttons small-buttons blue tooltips-left tooltips-light normal-case md fa fa-sitemap"
              title="Show/Hide Model"
              ng-click="showModel(concept)"
              ng-if="!isStatic"><span ng-if="modelVisible"> Hide Model </span><span
        ng-if="!modelVisible"> Show Model </span></button>
      <button ng-if="!isStatic" type="button"
              class="btn-default editbuttons small-buttons orange darken-3 md fa fa-close tooltips-left tooltips-light normal-case"
              ng-click="removeConcept(concept)"><span>Remove concept from edit panel</span></button>
    </div>
  </div>

  <!-- Toggle-able collapsed concept elements -->
  <div ng-show="!isCollapsed" class="editHeightSelector">

    <!-- rows: Concept Descriptions -->
    <div ng-repeat="description in getDescriptions(true)">
      <div class="row darken-3 p-t-5 grey ">
        <div class="col-md-12 no-padding color_{{relationship.groupId}}"
             drop-channel="descriptionObj"
             ui-on-drop="dropDescription(description, $data)"
             drag-enter-class="sca-drag-target"
             drag-hover-class="sca-drag-hover">

          <button ng-click="setDescriptionProperties(description)"
                  class="btn-default grey darken-3 md morebuttons fa fa-ellipsis-v more-button-width"
                  popover-template="'shared/component-more/descriptionMore.html'" popover-placement="left"
                  ng-click="populateDescriptionMore(description)"></button>

          <button
            class="btn-default grey darken-3 md morebuttons md-open-with drag-button-width"
            ui-draggable="true" drag="description" drag-channel="descriptionObj" drag-image="getDragImageForDescription(description)"></button>

          <!-- Commented out until functional
          <button ng-if="!isStatic" type="button" class="amber md md-undo button-width" title="Undo Changes"></button>


          <button ng-if="!isStatic" type="button" class=" blue accent-2 md md-history button-width"
                  title="Undo Changes"></button> -->

          <!-- Active/Inactive -->
          <button type="button"
                  style="vertical-align: bottom"
                  ng-disabled="isStatic"
                  ng-click="toggleDescriptionActive(description)"
                  ng-class="[btn-default, md, 'fa fa-power-off button-width', {green : description.active}, {red: !description.active}]"
                  title="Active/Inactive"></button>

          <!-- Case Significance -->
          <button type="button" class=" blue accent-2 button-width custom-button text-center" ng-disabled="isStatic"
                  title="Case Significance " ng-click="toggleCaseSignificance(description)">

            <span class="md col-md-12 no-padding text-center">{{getCaseSignificanceDisplayText(description)}}</span>


          </button>

          <!-- Term -->
          <div class="pull-left description no-padding">


            <textarea ng-if="description.type !== 'TEXT_DEFINITION'" ng-change="updateDescription(description)"
                      ng-model-options="{updateOn: 'blur'}"
                      ng-disabled="description.effectiveTime"
                      maxlength="255"
                      ng-model="description.term"
                      class=" msd-elastic resizable-text form-control color_{{relationship.groupId}}" type="text"
                      placeholder="Description">
            </textarea>
            <textarea ng-if="description.type === 'TEXT_DEFINITION'" style=""
                      class="msd-elastic resizable-text form-control color_{{relationship.groupId}}"
                      ng-change="updateDescription(description)"
                      ng-model-options="{updateOn: 'blur'}"
                      ng-disabled="description.effectiveTime"
                      maxlength="4096"
                      ng-model="description.term" type="text"
                      placeholder="Description">
            </textarea>
          </div>

          <!-- TypeId -->
          <div class="pull-left typeid">
            <select ng-disabled="description.effectiveTime || isStatic"
                    ng-options="descTypeId.name as descTypeId.abbr for descTypeId in descTypeIds"
                    ng-model="description.type" ng-change="updateDescription(description)"
                    name="select-type" id="select-type-choice" class="form-control color_{{relationship.groupId}}"
                    ui-on-drop="">
            </select>
          </div>

          <!-- Dialect / Acceptability: Never displayed for FSN -->
          <div>
            <!-- en-us acceptability -->
            <button type="button"
                    class=" blue accent-2 button-width-acceptability custom-button"
                    ng-disabled="isStatic || description.effectiveTime || description.type === 'FSN'"
                    title="Case Significance " ng-click="toggleAcceptability(description, 'en-us')"> <span
              class="md col-md-12 no-padding text-center">us:
                                                                                                    {{getAcceptabilityDisplayText(description,
                                                                                                    'en-us')}}</span>
            </button>

            <!-- en-gb acceptability -->
            <button type="button" class=" blue accent-2 button-width-acceptability custom-button"
                    ng-disabled="isStatic || description.effectiveTime  || description.type === 'FSN'"
                    title="Case Significance " ng-click="toggleAcceptability(description, 'en-gb')"> <span
              class="md col-md-12 no-padding text-center">gb:
                                                                                                    {{getAcceptabilityDisplayText(description,
                                                                                                    'en-gb')}}</span>
            </button>
          </div>

          <div ng-show="!isStatic">

            <button ng-if="!isStatic" type="button" ng-click="addDescription($index)"
                    class="btn-default add-buttons md fa fa-plus plus-button-width  pull-right tooltips-left tooltips-light normal-case">
              <span>Add New Description</span></button>

            <button type="button" ng-click="removeDescription(description)"
                    ng-if="!description.effectiveTime"
                    class="btn-default add-buttons md fa fa-minus plus-button-width  pull-right tooltips-left tooltips-light normal-case">
              <span>Remove Description</span></button>

          </div>


        </div>
      </div>
    </div>

    <!-- rows: Concept IsA Relationships -->
    <div ng-repeat="relationship in getRelationships(true)">

      <div class="row darken-3  grey ">

        <div class="col-md-12 no-padding p-t-5  color_{{relationship.groupId}}"
             ng-if="relationship.characteristicType === 'STATED_RELATIONSHIP'"
             drop-channel="relationshipObj"
             ui-on-drop="dropRelationship(relationship, $data)"
             drag-enter-class="sca-drag-target"
             drag-hover-class="sca-drag-hover">

<div class="p-t-5 ">
          <button class="btn-default grey darken-3 md morebuttons more-button-width fa fa-ellipsis-v button-width"
                  ng-click="setRelationshipProperties(relationship)"
                  popover-template="'shared/component-more/relationshipMore.html'" popover-placement="left"
                  title="Some title here"
            ></button>

          <button
            class="btn-default grey darken-3 md morebuttons pull-left md-open-with drag-button-width "
            ui-draggable="true" drag="relationship" drag-channel="relationshipObj" drag-image="getDragImageForRelationship(relationship)"></button>

          <!-- TODO Fix this   Note: due to weird behavior with ng-class, need to manually add bottom alignment -->
          <button type="button"
                  style="vertical-align: bottom"
                  ng-disabled="isStatic"
                  ng-click="toggleRelationshipActive(relationship)"
                  ng-class="[btn, btn-default, editbuttons, md, 'fa fa-power-off button-width', {green : relationship.active}, {red: !relationship.active}]"
                  title="Active/Inactive"></button>

          <!-- relationship group -->
          <div class="pull-left rolegroup">
            <textarea style="" class="msd-elastic" ng-model="relationship.groupId"
                      ng-model-options="{updateOn: 'blur'}"
                      ng-change="updateRelationship(relationship)"
                      class="form-control color_{{relationship.groupId}}" type="text" placeholder="#"
                      ui-on-drop="dropNullOp()">
            </textarea>
          </div>

          <!-- attribute type' -->
          <div class="pull-left is_a"
               drag-enter-class="sca-drag-target"
               drag-hover-class="sca-drag-hover"
               drop-channel="conceptPropertiesObj"
               ui-on-drop="dropRelationshipType(relationship, $data)"
               drop-validate="!relationship.effectiveTime && !isStatic">

            <textarea type="text"
                      ng-model="relationship.type.fsn"
                      ng-disabled="relationship.effectiveTime"
                      class="sca-top"
                      typeahead="suggestion as suggestion.concept.fsn for suggestion in getConceptsForTypeahead($viewValue)"
                      typeahead-focus-first="false"
                      typeahead-wait-ms="500"
                      typeahead-on-select="setRelationshipTypeConcept(relationship, $item)"
                      typeahead-editable="false" typeahead-min-length="3">


            </textarea>
            <span class="pull-left md md-open-with drag-button-width "
                  ui-draggable="true"
                  drag="getConceptIdNamePairFromAttributeType(relationship)"
                  drag-channel="conceptPropertiesObj"
                  drag-image="getDragImageForConcept(relationship.type.fsn)"></span>

          </div>

          <!-- linked concept -->
          <div class="pull-left sourcename"
               drag-enter-class="sca-drag-target"
               drag-hover-class="sca-drag-hover"
               drop-channel="conceptPropertiesObj"
               ui-on-drop="dropRelationshipTarget(relationship, $data)"
               drop-validate="!relationship.effectiveTime && !isStatic">

            <textarea type="text"
                      ng-model="relationship.target.fsn"
                      ng-disabled="relationship.effectiveTime"
                      class="sca-top"
                      typeahead="suggestion as suggestion.concept.fsn for suggestion in getConceptsForTypeahead($viewValue)"
                      typeahead-focus-first="false"
                      typeahead-wait-ms="500"
                      typeahead-on-select="setRelationshipTargetConcept(relationship, $item)"
                      typeahead-editable="false" typeahead-min-length="3"></textarea>

                        <span class="pull-left md md-open-with drag-button-width "
                              ui-draggable="true"
                              drag="getConceptIdNamePairFromRelationshipTarget(relationship)"
                              drag-channel="conceptPropertiesObj"
                              drag-image="getDragImageForConcept(relationship.target.fsn)"></span>
          </div>
          <div ng-if="!isStatic">
            <button type="button" ng-click="addIsaRelationship($index)"
                    class="btn-default add-buttons md fa fa-plus button-width-plus pull-right tooltips-left tooltips-light normal-case"
                    title="Add New Is A Relationship"></button>

            <button type="button" ng-click="removeRelationship(relationship)"
                    ng-if="!relationship.effectiveTime"
                    class="btn-default add-buttons md fa fa-minus button-width-minus pull-right tooltips-left tooltips-light normal-case">
              <span>Remove Relationship</span></button>

          </div>
          </div>
        </div>

      </div>


    </div>

    <div class="clearfix"></div>


  </div>
</div>

