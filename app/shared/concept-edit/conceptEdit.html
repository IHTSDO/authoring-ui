<div class="edits editing-form darken-3 grey">


  <!-- begin validation error -->
  <div class="alert alert-dismissible alert-danger validation" ng-show="errors.length > 0">
    <button class="btn btn-default md md-close pull-right white" ng-click="errors = []" style="background: transparent"
            tabindex="0"></button>
    <h4>Error!</h4>

    <div ng-repeat="error in errors">
      <div ng-bind="error"></div>
    </div>
  </div>
  <div class="alert alert-dismissible alert-warning validation" ng-show="warnings.length > 0">
    <button class="btn btn-default md md-close pull-right white" ng-click="warnings = []"
            style="background: transparent" tabindex="0"></button>
    <h4>Warning!</h4>

    <div ng-repeat="warning in warnings">
      <div ng-bind="warning"></div>
    </div>
  </div>

  <div class="alert alert-dismissible validation" ng-show="concept.templateMessages.length > 0"
       ng-repeat="message in concept.templateMessages"
       ng-class="[{ 'alert-warning' : message.type === 'Warning'}, { 'alert-danger' : message.type === 'Error' }, { 'alert-info' : message.type === 'Message'}]">
    <button class="btn btn-default md md-close pull-right white" ng-click="concept.templateMessages = []"
            style="background: transparent"
            tabindex="0"></button>
    <h4 ng-bind="message.message"></h4>

  </div>


  <!-- end validation error -->
  <!-- The concept itself -->
  <style>

    .new-concept .grey.darken-4 {
      background-color: #ffcadc !important;
      color: #212121 !important
    }

    .new-concept .concept-headers:first-child {
      padding-top: 3px !important
    }

    .template-term {
      background-color: red !important;
    }

    .template-slot {
      background-color: red !important;
    }
  </style>
  <div ng-class="[{'new-concept' : componentStyles.isNew}]">


    <div class="row grey darken-4 concept-headers" ng-class="getConceptStyle()" style="margin-right:0px;">

      <div class="pull-left col-md-1 no-padding">


        <button ng-click="setConceptProperties(concept, $event)" type="button" id="conceptMoreButton"
                class="btn btn-default morebuttons grey darken-4 md fa-sca fa-ellipsis-v more-button-width tooltips-bottom tooltips-light small-size-tooltip normal-case"
                popover-template="'shared/component-more/conceptMore.html'"
                popover-placement="{{popoverDirection}}"
                popover-trigger="click: click"
                popover-append-to-body="true">
          <span>More details</span>
        </button>

      </div>

      <!-- concept name -->
      <div class="col-md-6 no-padding title-text" style="margin-left:-25px;">

        <button type="button" class="btn-default grey darken-4 title-text fsn-title-button">
          <span ng-hide="!concept.fsn && !concept.effectiveTime" class="fsn">{{concept.fsn}}   <span
            ng-show="componentStyles.isNew "><strong>-New Concept</strong></span></span>

          <span ng-show="!concept.fsn && !concept.effectiveTime && !template" style="color:grey" class="fsn">Unsaved Concept</span>
          <span ng-show="!concept.fsn && !concept.effectiveTime && template" style="color:grey" class="fsn">Template Concept: {{concept.template.name}}</span>

        </button>


      </div>

      <div class="  no-margin edits concept-title col-md-5 pull-right no-padding">
        <div class=" p-t-3  ">


          <button type="button"
                  class="deep-purple lighten-2 btn-default md md-save tooltips-bottom editbuttons small-size-tooltip small-buttons"
                  ng-click="saveConcept()"
                  ng-if="!isMerge && isModified && !isStatic"
                  ng-disabled="saving">
            <span> Save Concept </span>
          </button>


          <button type="button"
                  class="btn-default save-button small-buttons red lighten-2 md md-assignment-turned-in tooltips-bottom tooltips-light normal-case "
                  ng-click="saveConcept()" ng-if="isMerge" style="margin-bottom: -2px;">
            <span> Accept This Version </span>
          </button>
          <!-- Revert button only appears if parent is specified -->
          <button ng-if="parentBranch" type="button" class="btn btn-default revert-button" ng-click="revertConcept()">
            Revert
          </button>


          <!-- control buttons -->
          <button type="button" style="vertical-align: bottom"
                  ng-click="toggleConceptActive(concept, true)"
                  ng-if="isInactivation  || !isLockedModule(concept.moduleId) && !concept.released"
                  class="red small-buttons tooltips-bottom status-concept tooltips-light normal-case editbuttons fa-sca fa-minus">

            <span ng-if="!isStatic  && !isInactivation">Delete Unpublished Concept</span>
          </button>
          <button type="button" style="vertical-align: bottom"
                  ng-class="[btn-default, editbuttons, ' fa-sca fa-power-off', {green : concept.active}, {red: !concept.active}]"
                  ng-click="toggleConceptActive(concept)"
                  ng-if="concept.released"
                  ng-disabled="isInactivation  || isLockedModule(concept.moduleId) && concept.released"
                  class="small-buttons tooltips-bottom status-concept tooltips-light normal-case">

            <span ng-if="!isStatic  && !isInactivation"> Activate/ inactivate concept </span>
            <span ng-if="!isStatic && isInactivation">Inactivation in progress, cannot change active status</span>
            <span ng-if="isStatic || isLockedModule(concept.moduleId)"> {{concept.active ? 'Active Concept' : 'InactiveConcept'}} </span>
          </button>
          <button type="button"
                  style="vertical-align: bottom"
                  class="btn-default editbuttons small-buttons tooltips-bottom tooltips-light large-size-tooltip normal-case"
                  ng-class="[{'red fa-sca fa-level-down' : !hideInactive}, {'fa-sca fa-level-up green' : hideInactive}]"
                  ng-click="toggleHideInactive()"><span> Show/hide inactive components </span>
          </button>


          <button type="button"
                  class="btn-default editbuttons small-buttons amber md md-undo tooltips-bottom tooltips-light small-size-tooltip"
                  ng-click="undo()" ng-disabled="conceptHistoryPtr < 1" ng-if="!isStatic">
            <span>Undo Changes</span>
          </button>
          <button type="button"
                  class="btn-default editbuttons small-buttons amber md md-redo tooltips-bottom tooltips-light small-size-tooltip"
                  ng-click="redo()" ng-if="!isStatic" ng-disabled="conceptHistoryPtr === conceptHistory.length - 1">
            <span>Redo Changes</span>
          </button>
          <button type="button"
                  class="btn-default editbuttons small-buttons deep-purple lighten-2 md md-history tooltips-bottom tooltips-light"
                  ng-click="undoAll()" ng-if="!isStatic" ng-disabled="!isModified">
            <span>Revert to Saved</span>
          </button>

          <button type="button"
                  class="btn-default editbuttons small-buttons orange darken-3 md fa-sca fa-close tooltips-bottom large-size-tooltip offset-tooltip-right tooltips-light normal-case"
                  ng-click="removeConcept(concept)"><span>Remove concept from edit panel</span>
          </button>
          <div ng-repeat="field in concept.additionalFields">
                    <textarea class="msd-elastic resizable-text" ng-model-options="{updateOn: 'blur'}"
                              ng-model="field.value" type="text" placeholder="{{field}}" autofocus>
                    </textarea>
          </div>

          <button ng-if="concept.definitionStatus === 'FULLY_DEFINED'"
                  ng-disabled="isStatic || isLockedModule(concept.moduleId) || concept.template"
                  class="p-t-5 p-l-3 white-text primitive-buttons tooltips-bottom small-size-tooltip tooltips-light"
                  ng-click="toggleConceptDefinitionStatus(isStatic)">

            <div class="badge alert-warning ng-binding">≡&nbsp; </div>
            <span>Fully Defined</span>
          </button>
          <button ng-if="concept.definitionStatus === 'PRIMITIVE'"
                  ng-disabled="isStatic || isLockedModule(concept.moduleId  || concept.template)"
                  class=" p-t-5 p-l-3 primitive-buttons white-text tooltips-bottom small-size-tooltip tooltips-light"
                  ng-click="toggleConceptDefinitionStatus(isStatic)">
            <div class="badge alert-warning ng-binding">&nbsp; </div>
            <span>Primitive</span>
          </button>


          <button ng-init="isCollapsed = false" class="btn-default editbuttons small-buttons"
                  ng-click="collapse(concept)"
                  type="button"
                  ng-class="[btn, btn-default, darkbuttons, grey, 'darken-4', 'toggle-buttons', md, {'fa-sca fa-caret-down' : isCollapsed, ' fa-sca fa-caret-up' : !isCollapsed}]"></button>

        </div>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="validation red" ng-repeat="error in validation.errors[concept.conceptId]"><strong>Convention
      Error:</strong>
      <div ng-bind="error"></div>
    </div>
  </div>
  <div class="row">
    <div class="validation orange darken-1" ng-repeat="warning in validation.warnings[concept.conceptId]"><strong>Convention
      Warning:</strong>
      <div ng-bind="warning"></div>
    </div>
  </div>


  <!-- Toggle-able collapsed concept elements -->
  <div ng-show="!isCollapsed" class="editHeightSelector darken-3 grey ">

    <div ng-show="concept.definitionOfChanges" class="">

      <div class="row">
        <style>

        </style>
        <div class="change_request_container {{concept.definitionOfChanges.changeType}}">
          <div class=" m-l-5 fa {{concept.definitionOfChanges.changeType}}"></div>
          <span class="change_type_{{concept.definitionOfChanges.changeType}}"></span></div>
      </div>
      <div class="row">

        <div class="col-md-11">

          <div class="row"
               ng-repeat="(key, val) in crsFilter(concept.definitionOfChanges)"
               ng-show="!concept.hideCrsDetails">
            <div class="col-md-12">
              {{key}}: {{val}}
            </div>


          </div>
        </div>
      </div>


    </div>


    <!-- rows: Concept Descriptions -->
    <div ng-repeat="description in concept.descriptions"

         ng-class="getComponentStyle(description.descriptionId, null, '', description)"
         class="">

      <div ng-show="description.definitionOfChanges" class="">

        <div class="row">
          <div class="change_request_container {{description.definitionOfChanges.changeType}}">
            <div class=" m-l-5 fa {{description.definitionOfChanges.changeType}}"></div>
            <span class="change_type_{{description.definitionOfChanges.changeType}}"></span></div>
        </div>
        <div class="row"></div>

        <div class="col-md-12">

          <div class="row"
               ng-repeat="(key, val) in crsFilter(description.definitionOfChanges)"
               ng-show="!description.hideCrsDetails">
            <div class="col-md-12" ng-show="val">
              {{key}}: {{val}}
            </div>

          </div>
        </div>


      </div>

      <div class="row darken-3 p-t-5 grey dividercolor_{{relationship.groupId}} ">
        <div class="col-md-12 no-padding color_{{relationship.groupId}} def_{{concept.definitionStatus}} "
             drop-channel="descriptionObj" ui-on-drop="dropDescription(description, $data)"
             drag-enter-class="sca-drag-target" drag-hover-class="sca-drag-hover">

          <button id="myTextArea" name="myTextArea" ng-click="setDescriptionProperties(description, $event)"
                  class="btn-default grey darken-3 md morebuttons fa-sca fa-ellipsis-v more-button-width small-size-tooltip tooltips-bottom tooltips-light normal-case"
                  popover-template="'shared/component-more/descriptionMore.html'"
                  popover-placement="{{popoverDirection}}"
                  popover-append-to-body="true">
            <span>More details</span>
          </button>
          <button
            class="btn-default grey darken-3 md morebuttons md-open-with drag-button-width small-size-tooltip tooltips-bottom "
            ui-draggable="true" drag="description" drag-channel="descriptionObj"
            drag-image="getDragImageForDescription(description)">
            <span>Drag this row</span>
          </button>
          </button>


          <!-- Active/Inactive -->
          <button type="button" style="vertical-align: bottom"
                  ng-disabled="isStatic || !description.released || isLockedModule(description.moduleId)"
                  ng-click="toggleDescriptionActive(description)"
                  ng-class="[btn-default, md, 'fa-sca fa-power-off button-width', {green : description.active}, {red: !description.active}]"
                  class="tooltips-bottom small-size-tooltip">
            <span ng-if="isStatic">Active/Inactive</span>
            <span ng-if="!isStatic && description.released">Toggle Active/Inactive</span>
            <span ng-if="!isStatic && !description.released">Cannot inactivate unreleased description</span>
          </button>

          <!-- Case Significance -->
          <button type="button"
                  class=" blue accent-2 button-width custom-button text-center tooltips-bottom tooltips-light xxlarge-size-tooltip normal-case"
                  ng-disabled="isStatic || isLockedModule(description.moduleId)"
                  ng-click="toggleCaseSignificance(description)">

            <div class="text-center">{{getCaseSignificanceDisplayText(description)}}</div>

            <span><div class="{{getCaseSignificanceDisplayText(description)}}"></div></span>
          </button>

          <!-- Term -->
          <div class="pull-left description no-padding"
               ng-class="getComponentStyle(description.descriptionId, 'term', null)">



                        <textarea ng-if="description.type === 'FSN'" ng-change="updateDescription(description)"
                                  ng-model-options="{updateOn: 'blur'}"
                                  ng-disabled="isStatic || description.released || isLockedModule(description.moduleId)"
                                  maxlength="255"
                                  ng-model="description.term"
                                  class="form-control msd-elastic: \n;"
                                  ng-class="[{'template-term' : description.template}, {'color_{{relationship.groupId}}' : !description.template}]"
                                  type="text"
                                  placeholder="Description">
                        </textarea>

            <textarea autofocus ng-if="description.type === 'SYNONYM'"
                      ng-change="updateDescription(description)" ng-model-options="{updateOn: 'blur'}"
                      ng-disabled="isStatic || description.released || isLockedModule(description.moduleId)"
                      maxlength="255"
                      ng-model="description.term"
                      ng-class="[{'template-term' : description.template}, {'color_{{relationship.groupId}}' : !description.template}]"
                      class="form-control  msd-elastic: \n;" type="text"
                      placeholder="Description">
                        </textarea>
            <textarea ng-if="description.type === 'TEXT_DEFINITION'"
                      maxlength="2048"
                      ng-change="updateDescription(description)"
                      ng-disabled="isStatic || description.released || isLockedModule(description.moduleId)"
                      ng-model-options="{updateOn: 'blur'}"
                      ng-model="description.term" type="text" placeholder="Description"
                      ng-class="[{'template-term' : description.template}, {'color_{{relationship.groupId}}' : !description.template}]"
                      class="form-control msd-elastic: \n;" autofocus>
                        </textarea>
          </div>

          <!-- TypeId -->
          <div class="pull-left typeid">
            <select ng-disabled="description.released || isStatic || isLockedModule(description.moduleId)"
                    ng-options="descTypeId.name as descTypeId.abbr for descTypeId in descTypeIds"
                    ng-model="description.type" ng-change="updateDescription(description)" name="select-type"
                    id="select-type-choice" class="form-control color_{{relationship.groupId}}" ui-on-drop="">
            </select>
          </div>

          <!-- Dialect / Acceptability -- never alterable for FSN -->
          <div>

            <!-- button for each dialect key -->
            <button ng-repeat="dialectId in getDialectIdsForDescription(description)"
                    type="button"
                    class=" blue accent-2 button-width-acceptability custom-button tooltips-bottom small-size-tooltip"
                    ng-disabled="isStatic || (description.type === 'FSN' && !isExtensionDialect(dialectId)) || (isLockedModule(description.moduleId) && !isExtensionDialect(dialectId))"
                    ng-click="toggleAcceptability(description, dialectId)">
              <div class="md col-md-12 no-padding text-center">{{getAcceptabilityDisplayText(description, dialectId)}}
              </div>
              <span> {{getAcceptabilityTooltipText(description, dialectId)}}</span>
            </button>


          </div>


          <div ng-show="!isStatic">

            <button ng-if="!isStatic" type="button" ng-click="addDescription($index)"
                    class="btn-default add-buttons md fa-sca fa-plus plus-button-width  pull-right tooltips-bottom medium-size-tooltip offset-tooltip-right">
              <span>Add New Description</span>
            </button>

            <button type="button" ng-click="removeDescription(description)"
                    ng-if="!description.effectiveTime && !description.released"
                    class="btn-default add-buttons md fa-sca fa-minus plus-button-width  pull-right tooltips-bottom medium-size-tooltip offset-tooltip-right">
              <span>Remove Description</span>
            </button>

          </div>

          <div ng-if="description.additionalFields" ng-repeat="field in description.additionalFields">
                        <textarea class="resizable-text msd-elastic: \n;" ng-model-options="{updateOn: 'blur'}"
                                  ng-model="field.value" type="text" placeholder="{{field}}">
                        </textarea>
          </div>

        </div>
      </div>
      <div class="row">
        <div class="validation red" ng-repeat="error in validation.errors[description.descriptionId]"><strong>Convention
          Error:</strong>
          <div ng-bind="error"></div>
        </div>
      </div>
      <div class="row">
        <div class="validation orange darken-1" ng-repeat="warning in validation.warnings[description.descriptionId]">
          <strong>Convention Warning:</strong>
          <div ng-bind="warning"></div>
        </div>
      </div>
      <div class="row">
        <div class="validation darken-1 p-5"
             ng-class="[{ 'orange' : message.type === 'Warning'}, { 'red' : message.type === 'Error' }, { 'blue' : message.type === 'Message'}]"
             ng-repeat="message in description.templateMessages">
          <strong>Template {{message.type}}:</strong>
          <div ng-bind="message.message"></div>
        </div>
      </div>


    </div>


    <!-- rows: Relationships -->
    <div ng-repeat="(groupId, relationshipGroup) in relationshipGroups">
      <div ng-if="showRelationshipGroup(relationshipGroup)">
        <div class="role_group_divider_top_{{groupId}} "></div>
        <div ng-repeat="relationship in relationshipGroup | filter:filterRelationships"
             ng-class="getComponentStyle(relationship.relationshipId, null, '', relationship)"
             class="{{relationship.target.definitionStatus}}">

          <div ng-show="relationship.definitionOfChanges" class="">

            <div class="row">
              <div class="change_request_container {{relationship.definitionOfChanges.changeType}}">
                <div class=" m-l-5 fa {{relationship.definitionOfChanges.changeType}}"></div>
                <span class="change_type_{{relationship.definitionOfChanges.changeType}}"></span></div>
            </div>


            <div class="row"
                 ng-repeat="(key, val) in crsFilter(relationship.definitionOfChanges)"
                 ng-show="!relationship.hideCrsDetails">
              <div class="col-md-12" ng-show="val">
                {{key}}:{{val}}
              </div>

            </div>


          </div>


          <div class="row darken-3 edits-row color_{{relationship.groupId}} "
               ng-class="getComponentStyle(relationship.relationshipId, null, '')">

            <div class="col-md-11 no-padding left-of-edit" drop-channel="relationshipObj"
                 ui-on-drop="dropRelationship(relationship, $data)" drag-enter-class="sca-drag-target"
                 drag-hover-class="sca-drag-hover">

              <div class="">
                <button
                  class="btn-default grey darken-3 md morebuttons more-button-width small-size-tooltip fa-sca fa-ellipsis-v button-width tooltips-bottom tooltips-light normal-case"
                  ng-click="setRelationshipProperties(relationship, $event)"
                  popover-template="'shared/component-more/relationshipMore.html'"
                  popover-placement="{{popoverDirection}}"
                  popover-append-to-body="true">
                  <span>More details</span>
                </button>

                <button
                  class="btn-default grey darken-3 md morebuttons pull-left md-open-with drag-button-width small-size-tooltip tooltips-bottom"
                  ui-draggable="true" drag="relationship" drag-channel="relationshipObj"
                  drag-image="getDragImageForRelationship(relationship)">
                  <span>Drag This Row</span>
                </button>

                <!-- TODO Fix this   Note: due to weird behavior with ng-class, need to manually add bottom alignment -->
                <button type="button"
                        class="tooltips-bottom small-size-tooltip"
                        style="vertical-align: bottom"
                        ng-disabled="isStatic || !relationship.released || isLockedModule(relationship.moduleId) || template"
                        ng-click="toggleRelationshipActive(relationship)"
                        ng-class="[btn, btn-default, editbuttons, md, 'fa-sca fa-power-off button-width', {green : relationship.active}, {red: !relationship.active}]">
                  <span ng-if="isStatic">Active/Inactive</span>
                  <span ng-if="!isStatic && relationship.released">Toggle Active/Inactive</span>
                  <span ng-if="!isStatic && !relationship.released">Cannot inactivate unreleased relationship</span>
                </button>

                <!-- relationship group -->
                <div class="pull-left rolegroup tooltips-bottom small-size-tooltip">
                                    <textarea ng-disabled="isStatic  || isLockedModule(relationship.moduleId) || template"
                                              ng-model="relationship.groupId" ng-model-options="{updateOn: 'blur'}"
                                              ng-change="updateRelationship(relationship, true)"
                                              class="form-control rg msd-elastic: \n;"
                                              type="text" placeholder="#" ui-on-drop="dropNullOp()">
                                    </textarea>
                  <span>Role Group</span>
                </div>

                <!-- attribute type' -->
                <div class="pull-left is_a is_a_bg"
                     drag-enter-class="sca-drag-target"
                     drag-hover-class="sca-drag-hover"
                     drop-channel="conceptPropertiesObj"
                     ui-on-drop="dropRelationshipType(relationship, $data)"
                     drop-validate="!relationship.effectiveTime && !isStatic">

                                    <textarea type="text" ng-model="relationship.type.fsn"
                                              ng-disabled="relationship.effectiveTime || isStatic || isLockedModule(relationship.moduleId) || template"
                                              class="resizable-text form-control msd-elastic: \n;"

                                              typeahead="suggestion as suggestion.fsn.term for suggestion in allowedAttributes | filter:$viewValue:emptyOrMatch"
                                              typeahead-focus-first="false"
                                              typeahead-loading="typeTypeaheadLoading"
                                              typeahead-wait-ms="700"
                                              typeahead-on-select="setRelationshipTypeConcept(relationship, $item)"
                                              typeahead-editable="false"
                                              typeahead-min-length="0">

                                    </textarea>
                  <div class="pull-left md drag-button-width small-size-tooltip tooltips-bottom"
                       ng-class="[{'md-open-with' : !typeTypeaheadLoading}, {'md-cached' : typeTypeaheadLoading}]"
                       ui-draggable="true"
                       drag="getConceptIdNamePairFromAttributeType(relationship)"
                       drag-channel="conceptPropertiesObj"
                       drag-image="getDragImageForConcept(relationship.type.fsn)">
                    <span>Drag this component</span>
                  </div>

                </div>

                <!-- linked concept -->
                <div class="pull-left sourcename" drag-enter-class="sca-drag-target" drag-hover-class="sca-drag-hover"
                     drop-channel="conceptPropertiesObj" ui-on-drop="dropRelationshipTarget(relationship, $data)"
                     drop-validate="!relationship.effectiveTime && !isStatic"
                     ng-class="getTargetSlotStyle(relationship)">

                  <textarea type="text" ng-model="relationship.target.fsn"
                            ng-disabled="relationship.effectiveTime || isStatic  || isLockedModule(relationship.moduleId) || (template && !relationshipHasTargetSlot(relationship, template))"
                            class="resizable-text relationship msd-elastic: \n;"
                            ng-class="[{'template-slot' : relationship.targetSlot}]"
                            typeahead="suggestion as suggestion.tempFsn for suggestion in getConceptsForValueTypeahead(relationship.type.conceptId, $viewValue, branch, relationship.template)"
                            typeahead-loading="targetTypeaheadLoading" typeahead-focus-first="false"
                            typeahead-wait-ms="700"
                            typeahead-on-select="setRelationshipTargetConcept(relationship, $item)"
                            typeahead-editable="false" typeahead-min-length="3"></textarea>
                  <div class="pull-left drag-button-width small-size-tooltip tooltips-bottom "
                       ng-class="[{'md-open-with' : !targetTypeaheadLoading}, {'md-cached' : targetTypeaheadLoading}]"
                       ui-draggable="true" drag="getConceptIdNamePairFromRelationshipTarget(relationship)"
                       drag-channel="conceptPropertiesObj"
                       drag-image="getDragImageForConcept(relationship.target.fsn)">
                    <span>Drag This Component</span>
                  </div>
                </div>

                <div ng-if="relationship.target.definitionStatus === 'FULLY_DEFINED'"
                     class="pull-left p-t-5 p-l-3 white-text tooltips-bottom small-size-tooltip">
                  <div class="badge alert-warning ng-binding pull-left">≡&nbsp; </div>
                  <span>Fully Defined</span>
                </div>
                <div ng-if="relationship.target.definitionStatus === 'PRIMITIVE'"
                     class="pull-left p-t-5 p-l-3 white-text tooltips-bottom small-size-tooltip">
                  <div class="badge alert-warning ng-binding pull-left">&nbsp; </div>
                  <span>Primitive</span>
                </div>


                <div ng-if="!isStatic && !isLockedModule(relationship.moduleId)")>

                  <button ng-if="!template" type="button" ng-click="addRelationship(groupId, relationship)"
                          class="btn-default add-buttons md fa-sca fa-plus button-width-plus pull-right tooltips-bottom medium-size-tooltip offset-tooltip-right ">
                    <span>Add New Relationship</span>
                  </button>

                  <button type="button" ng-click="removeRelationship(relationship)" ng-if="!relationship.released && (!template || !relationshipInLogicalModel(relationship, template))"
                          class="btn-default add-buttons md fa-sca fa-minus button-width-minus pull-right tooltips-bottom medium-size-tooltip offset-tooltip-right ">
                    <span>Remove Relationship</span>
                  </button>


                </div>


              </div>
              <div ng-if="relationship.additionalFields" ng-repeat="field in relationship.additionalFields">
                                <textarea class="resizable-text msd-elastic: \n;" ng-model-options="{updateOn: 'blur'}"
                                          ng-model="field.value" type="text" placeholder="{{field}}">
                                </textarea>
              </div>
            </div>

            <div class="col-md-1 no-padding color_{{relationship.groupId}} role-group-drag p-t-5"
                 drop-channel="relationshipGroupObj" ui-on-drop="dropRelationshipGroup($data)"
                 drag-enter-class="sca-relgroup-drag-target" drag-hover-class="sca-relgroup-drag-hover">
              <button ng-if="$index === 0"
                      class="btn-default md-open-with role-group-buttons tooltips-bottom medium-size-tooltip offset-tooltip-right  "
                      ui-draggable="true" drag="relationshipGroup" drag-channel="relationshipGroupObj"
                      drag-image="getDragImageForRelationshipGroup(relationshipGroup)">
                <span>Drag Relationship Group</span>
              </button>

              <button ng-if="!isStatic &&  !isLockedModule(relationship.moduleId) && !template"
                      class="btn-default md-exposure-plus-1 role-group-buttons tooltips-bottom medium-size-tooltip offset-tooltip-right "
                      ng-click="addRelationshipGroup()"><span>Add Relationship Group</span>
              </button>
            </div>
          </div>


          <div class="row">
            <div class="validation red" ng-repeat="error in validation.errors[relationship.relationshipId]"><strong>Convention
              Error:</strong>
              <div ng-bind="error"></div>
            </div>
          </div>
          <div class="row">
            <div class="validation orange darken-1"
                 ng-repeat="warning in validation.warnings[relationship.relationshipId]">
              <strong>Convention Warning:</strong>
              <div ng-bind="warning"></div>
            </div>
          </div>

          <div class="row">
            <div class="validation darken-1 p-5"
                 ng-class="[{ 'orange' : message.type === 'Warning'}, { 'red' : message.type === 'Error' }, { 'blue' : message.type === 'Message'}]"
                 ng-repeat="message in relationship.templateMessages">
              <strong>Template {{message.type}}:</strong>
              <div ng-bind="message.message">
              </div>
            </div>
          </div>


        </div>
        <div class="role_group_divider_bottom_{{groupId}}"></div>
      </div>
    </div>
    <div class="clearfix"></div>
  </div>
  <div ng-show="template" class="row grey darken-4 p-5" ng-class="getConceptStyle()"
       style="margin-right:0px;">

    <div class="col-md-1"></div>
    <div class="col-md-10 no-padding">

      <button
        class="btn btn-default morebuttons grey darken-4 tooltips-bottom tooltips-light normal-case"
      >
        <img src="images/snodragon_black.png" style="width:15px;">
        <span>SnoDragon Template</span></button>
      </button>



        <span
          style="padding-top:25px;">Template: {{template.name}}, version {{template.version}}</span>
      &nbsp;&nbsp;

      <button class="pull-right btn btn-default blue darken-2" ng-click="removeTemplate()"
              style="border-radius:8px; font-size:13px; padding-left:5px; padding-right: 5px; font-weight:400">&nbsp;Release
        Template&nbsp;</button>
    </div>
    <div class="col-md-1"></div>
  </div>

  <div ng-show="concept.conceptId && templateInitialized && !template && getSelectedTemplate() != null" class="row grey darken-4 p-5" ng-class="getConceptStyle()"
       style="margin-right:0px;">

    <div class="col-md-1"></div>
    <div class="col-md-10 no-padding">

      <button
        class="btn btn-default morebuttons grey darken-4 tooltips-bottom tooltips-light normal-case"
      >
        <img src="images/snodragon_black.png" style="width:15px;">
        <span>SnoDragon Template</span></button>
      </button>



      <span
        style="padding-top:25px;">Selected Template: {{getSelectedTemplate().name}}, version {{getSelectedTemplate().version}}</span>
      &nbsp;&nbsp;

      <button class="pull-right btn btn-default amber darken-4" ng-click="applyTemplate()"
              style="border-radius:8px; font-size:13px; padding-left:5px; padding-right: 5px; font-weight:400">&nbsp;Apply
        Template&nbsp;</button>
    </div>
    <div class="col-md-1"></div>
  </div>

</div>
