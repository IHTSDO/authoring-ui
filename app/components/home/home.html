<style>
  .promoted-check-box {
    color: #9B9B9B;
    padding-top: 15px;
  }

  .Available.badge {
    margin: 3px 3px 3px 3px;
  }
  
  .not_in_review {
    background-color: #e5e5e5;
	color:#a3a3a3;
}
.sca-light   .not_in_review {
    background-color: #fff;
	color:#a3a3a3;
}
 .not_in_review.btn-round  {
    background-color: #eeeeee;
	color:#cdcdcd;}
	.btn-center{margin: 0 auto; list-style:none;}
</style>

<div class="row no-gutter sca-container ">
  <div style="background-color:#474747" class="sca-column col-lg-3 col-md-3 col-sm-3 dashboard-sidebar" ng-include
       src="'shared/sidebar/sidebar.html'"></div>

  <div class="sca-content dash-tables col-lg-9 col-md-9 col-sm-9 pull-right">

    <!-- Author Tasks -->
    <section class="tables-data row no-gutter">
      <div class="card">

        <div class="row" style="margin-right:0px;">
          <div class="col-md-3 no-padding">
            <h3 class="table-title p-20">My Tasks</h3>
          </div>
          <div class="col-md-6">
            <div class="table-search">
              <input type="text" ng-model="tableParams.filter()['search']" class="form-control"
                     placeholder="Search My Tasks" autofocus/>

            </div>

          </div>
          <div class="col-md-2 promoted-check-box">
            <button class="btn btn-default form-control"
                    ng-class="[{'md-check-box' : showPromotedTasks}, {'md-check-box-outline-blank' : !showPromotedTasks}]"
                    ng-click="toggleShowPromotedTasks()" style="background: transparent">
              <span class="promoted-check-box">Show Promoted</span></button>
          </div>
          <div class="col-md-1">
            <div class="pull-right p-t-20">
              <button type="button" class="btn btn-round   btn-info ng-scope tooltips-left tooltips-light ">
                <div> {{tasks.length}}</div>
                <span>{{tasks.length}} tasks are assigned to you </span>

                <div class="ripple-wrapper"></div>
              </button>
              <button type="button" class="btn btn-round   btn-default tooltips-left tooltips-light "
                      title="Create New Task"
                      ng-click="openCreateTaskModal()">
                <div class="md md-add"></div>
                <span>Create a New Task</span>
              </button>
            </div>
          </div>
        </div>

        <div class="table-responsive white" style="margin-right:0px;">


          <table ng-table="tableParams" template-pagination="utilities/data-table-pager.html"
               class="table table-full table-full-small">
            <tr ng-repeat="task in $data" class="clickable-row">

              <td data-title="'Name'" sortable="'summary'" filter="{ 'summary': 'text' }"><a class="tooltips-right"
                                                                                             ng-href="#/tasks/task/{{task.projectKey}}/{{task.key}}/edit">
                {{task.summary}}<span> Click to open editing view</span></a>
              </td>
            
              <td data-title="'Task Id'" sortable="'taskKey'" filter="{ 'key': 'text' }">
                {{task.key}}
              </td>
              <td data-title="'Modified'" sortable="'updated'">
                {{task.updated | date: "yyyy-MM-dd"}}
              </td>

              <td data-title="'Rebase'">
                  <button
                    ng-show="(task.branchState === 'DIVERGED' || task.branchState === 'BEHIND' || task.branchState === 'STALE') && task.status !== 'Promoted'" type="button" ng-click="goToConflicts(task)"
                    class="btn btn-round  btn-center btn-default lighten-1 amber tooltips-left">
                    <div class="md md-sync "></div>
                    <span>Click to pull in changes from project</span>
                  </button>
              </td>

              <td data-title="'Classification'" sortable="'latestClassificationJson.status'">
                <a ng-href="#/tasks/task/{{task.projectKey}}/{{task.key}}/classify">
                  <button ng-show="task.latestClassificationJson != null"
                          type="button"
                          ng-class="[{
                          indicator_blue: task.latestClassificationJson.status === 'RUNNING'},
                         
                          {indicator_green : task.latestClassificationJson.status === 'COMPLETED' && task.latestClassificationJson.equivalentConceptsFound === false},
                          {indicator_green :  task.latestClassificationJson.status === 'COMPLETED' && task.latestClassificationJson.redundantStatedRelationshipsFound === false},
                          {indicator_red : task.latestClassificationJson.status === 'FAILED'},
                         
                          {indicator_grey : task.latestClassificationJson.equivalentConceptsFound === true && task.latestClassification.status === 'STALE'},
                           {indicator_green : task.latestClassificationJson.status === 'SAVED' && task.latestClassification.status !== 'STALE'},
                            {indicator_grey : task.latestClassificationJson.status === 'STALE'},
                           {indicator_amber : task.latestClassificationJson.redundantStatedRelationshipsFound === true},
                            {indicator_red : task.latestClassificationJson.equivalentConceptsFound === true}
                           ]"
                          class="btn btn-round   btn-default pull-left tooltips-right normalcase  ">
                    <div class="md md-notifications "></div> 
                                        <span > <div class="message_classification_{{task.latestClassificationJson.status}}"><div ng-if="task.latestClassificationJson.equivalentConceptsFound === true"> but equivalent relationships were found </div> </div></span>
                  </button>
                </a>


              </td>
      <td data-title="'Validation'" sortable="'latestValidationStatus'">
                <a class="tooltips-left" ng-href="#/tasks/task/{{task.projectKey}}/{{task.key}}/validate">
           <button ng-show="task.latestValidationStatus && task.latestValidationStatus !== 'NOT_TRIGGERED'"
                          type="button"
                          ng-class="[{indicator_blue : task.latestValidationStatus === 'SCHEDULED'},
                          {indicator_red : task.latestValidationStatus === 'FAILED'},
                          {indicator_blue : task.latestValidationStatus === 'VALIDATING'},
                          {indicator_blue : task.latestValidationStatus === 'BUILDING'},
                          {indicator_green : task.latestValidationStatus === 'COMPLETED'}]"
                          class="btn btn-round   btn-default lighten-2 pull-left ">
                                     

                    <div class="md md-school "></div> 
                      <span > <div class="message_validation_{{task.latestValidationStatus}}"> </div></span>
                  </button>
                </a>
              </td>


              
              <td data-title="'Status'" sortable="'status'">
                <div ng-if="task.status === 'IN_REVIEW' && !task.reviewer" class="badge {{task.status}}"> Ready for
                                                                                                          Review
                </div>
                <div ng-if="task.status === 'IN_REVIEW' && task.reviewer" class="badge {{task.status}}">
                  {{task.status}}
                </div>
                <div ng-if="task.status !== 'IN_REVIEW'" class="badge {{task.status}}"> {{task.status}}</div>
              </td>
              <td data-title="'Review'" sortable="'reviewer'" >
                <div ng-if="task.status === 'In Review'" class="badge {{task.status}}">{{task.status}}</div>
               
                 <div ng-show="task.status !== 'In Review'" class="badge not_in_review">Not In Review
        </div>

              </td>
              <td data-title="'Feedback'" sortable="'feedbackMessagesStatus'" >
        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
                <a class="tooltips-left feedbacktooltips" ng-href="#/tasks/task/{{task.projectKey}}/{{task.key}}/feedback">

                  <button ng-if="task.feedbackMessagesStatus === 'read'" type="button"
                          class="btn btn-round   btn-default  pink darken-1  "
                    >
                    <div class="md md-drafts"></div>
                    <span>View <br>Feedback</span>

                  </button>
                  <button ng-if="task.feedbackMessagesStatus === 'unread'" type="button"
                          class="btn btn-round   btn-default   pink darken-1  "
                          >
                    <div class="md md-email"></div>
                    <span>New <br>Feedback </span>
                  </button>
                
                </a>
              
              </td>
               

            </tr>
          </table>

        </div>

      </div>
    </section>


    <!-- Reviewer Tasks -->
    <section class="tables-data row no-gutter">
      <div class="card">

        <div class="row" style="margin-right:0px;">
          <div class="col-md-3 no-padding">
            <h3 class="table-title p-20">Review Tasks</h3>
          </div>
          <div class="col-md-6">
            <div class="table-search">
              <input type="text" ng-model="reviewTableParams.filter()['search']" class="form-control"
                     placeholder="Search Available Review Tasks" autofocus/>
            </div>
          </div>
          <div class="col-md-2 promoted-check-box">
            <button class="btn btn-default form-control"
                    ng-class="[{'md-check-box' : showPromotedReviews}, {'md-check-box-outline-blank' : !showPromotedReviews}]"
                    ng-click="toggleShowPromotedReviews()" style="background: transparent">
              <span class="promoted-check-box">Show Promoted</span></button>
          </div>
          <div class="col-md-1">
              <span class="pull-right p-t-20">
                  <button type="button" class="btn btn-round   btn-info ng-scope tooltips-left tooltips-light ">
                    {{reviewTasks.length}}
                    <span> {{reviewTasks.length}} reviews are in progress</span>
                  </button>
              </span>
          </div>
        </div>
        <!--          Left in as a placeholder for reviewer role functionality-->
        <!--        <div class="table-responsive white" style="margin-right:0px;" ng-if="isReviewer()">-->
        <div class="table-responsive white" style="margin-right:0px;">

          <table ng-table="reviewTableParams" template-pagination="utilities/data-table-pager.html"
                 class="table table-full table-full-small col-md-12 no-padding">
            <tr ng-repeat="task in $data" class="clickable-row">

              <td data-title="'Name'" sortable="'summary'" filter="{ 'summary': 'text' }">
                <a class="tooltips-right"
                   ng-click="viewReviewTask(task)"> {{task.summary}}<span> Click to open reviewer view</span></a>
              </td>
            
   <td data-title="'Task Id'" sortable="'taskKey'" filter="{ 'key': 'text' }">
                {{task.key}}
              </td>
                <td data-title="'Modified'" sortable="'updated'">
                {{task.updated | date: "yyyy-MM-dd"}}
              </td>
              <td data-title="'Author'" sortable="'assignee.displayName'" filter="{ 'author': 'text' }">
                {{task.assignee.displayName}}
              </td>
            
            
              <td data-title="'Classification'" sortable="'latestClassificationJson.status'">
                <a ng-href="#/tasks/task/{{task.projectKey}}/{{task.key}}/classify">
                     <button ng-show="task.latestClassificationJson != null"
                          type="button"
                          ng-class="[{
                          indicator_blue : task.latestClassificationJson.status === 'RUNNING'},
                         
                          {indicator_green : task.latestClassificationJson.status === 'COMPLETED'},
                          {indicator_red : task.latestClassificationJson.status === 'FAILED'},
                          {indicator_red : task.latestClassificationJson.equivalentConceptsFound === true || task.latestClassification.status === 'FAILED'},
                           {indicator_green : task.latestClassificationJson.status === 'SAVED'},
                            {indicator_grey : task.latestClassificationJson.status === 'STALE'},
                           {indicator_amber : task.latestClassificationJson.redundantStatedRelationshipsFound === true},
                           {indicator_green : task.latestClassificationJson.redundantStatedRelationshipsFound === false && task.latestClassificationJson.equivalentConceptsFound === false}]"
                          class="btn btn-round   btn-default pull-left tooltips-right">
                    <div class="md md-notifications "></div>
                                        <span > <div class="message_classification_{{task.latestClassificationJson.status}}"> </div></span>

                  </button>
                </a>


              </td>

              <td data-title="'Validation'" sortable="'latestValidationStatus'">
                <a class="tooltips-left" ng-href="#/tasks/task/{{task.projectKey}}/{{task.key}}/validate">
           <button ng-show="task.latestValidationStatus && task.latestValidationStatus !== 'NOT_TRIGGERED'"
                          type="button"
                          ng-class="[{indicator_blue : task.latestValidationStatus === 'SCHEDULED'},
                          {indicator_red : task.latestValidationStatus === 'FAILED'},
                          {indicator_blue : task.latestValidationStatus === 'VALIDATING'},
                          {indicator_blue : task.latestValidationStatus === 'BUILDING'},
                          {indicator_green : task.latestValidationStatus === 'COMPLETED'}]"
                          class="btn btn-round   btn-default lighten-2 pull-left ">
                                     

                    <div class="md md-school "></div> 
                      <span > <div class="message_validation_{{task.latestValidationStatus}}"> </div></span>
                  </button>
                </a>
              </td>

            
  <td data-title="'Review Status'" sortable="'reviewer'"  >
                <div ng-if="task.reviewer" class="badge {{task.status}}">{{task.status}}</div>
                <div ng-if="!task.reviewer" class="badge Available">Available</div>

              </td>
                      
              <td data-title="'Feedback'" sortable="'feedbackMessagesStatus'" >
                &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
                <a class="tooltips-left feedbacktooltips" ng-href="#/tasks/task/{{task.projectKey}}/{{task.key}}/feedback">

                  <button ng-if="task.feedbackMessagesStatus === 'read'" type="button"
                          class="btn btn-round   btn-default  pink darken-1  "
                    >
                    <div class="md md-drafts"></div>
                    <span>View <br>Feedback</span>

                  </button>
                  <button ng-if="task.feedbackMessagesStatus === 'unread'" type="button"
                          class="btn btn-round   btn-default   pink darken-1  "
                          >
                    <div class="md md-email"></div>
                    <span>New <br>Feedback </span>
                  </button>
                
                </a>
              </td>
   
            </tr>
          </table>

        </div>

      </div>
    </section>
  </div>

</div>




